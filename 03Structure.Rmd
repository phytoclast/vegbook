# Structure

This analysis of vegnasis package creates a vegetation profile by broadly defined plant type (growth habit).

```{r warning=FALSE, message = FALSE}
# remotes::install_github("phytoclast/vegnasis", dependencies = FALSE)
library(vegnasis)
library(ggplot2)

veg.raw <- vegnasis::nasis.veg
veg <- clean.veg(veg.raw)
veg <- veg |> fill.type.df() |> fill.hts.df()

veg.str <- summary.crown.thickness(veg, breaks = c(-4:160)/4) |> structure.fill.zero() |> subset(type %in% c('tree', 'shrub/vine', 'grass/grasslike',  'forb'))
veg.str.pct <- veg.str |> group_by(type, stratum, stratum.label, bottom, top) |>
  summarise(X25 = quantile(Cover, 0.25),
            X50 = quantile(Cover, 0.5),
            X75 = quantile(Cover, 0.75))

knitr::kable(
  head(veg.str, 25), booktabs = TRUE,
  caption = 'A table of the first 10 rows of the veg.str.pct data.'
)

```



```{r warning=FALSE, message = FALSE, fig.cap = "Structure of various plots."}

ggplot(veg.str.pct, aes(x = top, y = X50)) +
  # plot median
  geom_line() +
  # plot quantiles
  geom_ribbon(aes(ymin = X25, ymax = X75, x = top), alpha = 0.2) +
  coord_flip() +
  scale_x_continuous(name='height (m)', breaks=c(0:100)*5,  minor_breaks = NULL, limits = c(0,40))+
  scale_y_continuous(name='cover')+
  facet_wrap(~ type, scales = "free_x", nrow=1)


```
