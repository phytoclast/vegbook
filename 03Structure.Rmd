# Structure

This analysis of vegnasis package creates a vegetation profile by broadly defined plant type (growth habit).

```{r warning=FALSE, message = FALSE}

library(vegnasis)
library(ggplot2)

veg.raw <- vegnasis::nasis.veg
veg <- clean.veg(veg.raw)
veg <- veg |> fill.type.df() |> fill.hts.df()

veg.str <- summary.crown.thickness(veg, breaks = c(1:30)) |> structure.fill.zero() |> subset(type %in% c('tree', 'shrub/vine', 'grass/grasslike',  'forb'))
veg.str.pct <- veg.str |> group_by(type, stratum, stratum.label, bottom, top) |> summarise(X50 = quantile(Cover, 0.5),
                                                                                           X90 = quantile(Cover, 0.9),
                                                                                           X10 = quantile(Cover, 0.1))

knitr::kable(
  head(veg.str.pct, 10), booktabs = TRUE,
  caption = 'A table of the first 10 rows of the veg.str.pct data.'
)
```



```{r warning=FALSE, message = FALSE, fig.cap = "Structure of various plots."}

ggplot(veg.str.pct, aes(x = top, y = X50)) +
  # plot median
  geom_line() +
  # plot 10th & 90th quantiles
  geom_ribbon(aes(ymin = X10, ymax = X90, x = top), alpha = 0.2) +
  # invert depths
  xlim(c(0, 30)) +
  # flip axis
  coord_flip() +
  facet_wrap(~ type, scales = "free_x")


```
